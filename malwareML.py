import numpy as np
import pandas as pd
from sklearn import tree
from sklearn.ensemble import RandomForestClassifier
from sklearn.neighbors import KNeighborsClassifier


def machineLearnMalware() :

    dataSet = pd.read_csv('MalwareArtifacts.csv')
    fileData = pd.read_csv('inputData.csv')

    features = dataSet.iloc[:,[0,1,2,3,4,5,6,7]].values
    ifMalware = dataSet.iloc[:,8].values

    fileFeatures = fileData.iloc[:,[0,1,2,3,4,5,6,7]].values
    dtModel = tree.DecisionTreeClassifier() 
    dtModel.fit(features, ifMalware) 

    dtpredict = dtModel.predict(fileFeatures) 
    print(dtpredict)
    print("\n")
    rfModel = RandomForestClassifier() 
    rfModel.fit(features, ifMalware) 
    rfpredict = rfModel.predict(fileFeatures)  
    print(rfpredict)
    print("\n")
    knnModel = KNeighborsClassifier(n_neighbors=1)
    knnModel.fit(features, ifMalware)
    knpredict = knnModel.predict(fileFeatures)  
    print(knpredict)
    print("\n")

    predict = int(knpredict + dtpredict + rfpredict)
    return predict

